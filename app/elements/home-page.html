<dom-module is="home-page">
	<style>
		paper-card {
			elevation: 1;
			height: 50%;
			width: 50%;
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
		}
		paper-input {
			margin: auto;
			elevation: 2;
			width: 70%;
		}
		paper-button {
			background-color: red;
			width: 10em;
			margin-left: 50%;
			transform: translate(-50%, 0%);
		}
		a {
			text-decoration: none;
			color: white;
		}
	</style>
	<template>
		<firebase-document
			id="firebase"
			location="https://card-app.firebaseio.com/games"
			data="{{data}}"></firebase-document>
		<paper-card>
			<form is="iron-form" id="form">
				<header>Please enter a Game Name</header>
				<paper-input type="text" label="Game Name" value={{gameName::input}}></paper-input>
				<paper-button raised type="submit" on-tap="newGame">Start Game</paper-button>
			</form>
		</paper-card>
	</template>
	<script>
		HomePage = Polymer({
			is:'home-page',
			ready: function() {
				var _this = this;
				this.$.form.addEventListener('iron-form-presubmit', function(e) {
					_this.newGame(e);
				});
				this.firebase = this.$.firebase;
			},
			newGame: function(e) {
				this.gameId = this.gameName ? this.gameName.replace(' ', '-') : 'game-' + this.firebase.data.count;
				if (this.firebase.data[this.gameId]) {
					alert('This game name is already taken');
					e.preventDefault();
					return;
				}
				this.firebase.query.child(this.gameId).set({users:0, name:this.gameName || null});
				this.firebase.query.child('count').set(this.firebase.data.count + 1);
				MoreRouting.navigateTo('game',{gameId: this.gameId});
			}
		});
	</script>
</dom-module>